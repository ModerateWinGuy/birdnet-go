# Changelog

All notable changes to this project will be documented in this file.

## [unreleased]

### 🚀 Features

- Privacy filter to discard audio clips with human vocals
- Save all BirdNET prediction results into table Results
- *(audio)* Check user group membership on audio device open failure and print instructions for a fix
- *(docker)* Added support for multiplatform build
- *(conf)* New function to detect if running in container

### 🐛 Bug Fixes

- *(docker)* Install ca-certificates package in container image
- *(capture)* Set capture start to 5 seconds before detection instead of 4 seconds
- *(capture)* Increase audio capture length from 9 to 12 seconds
- *(rtsp)* Wait before restarting FFmpeg and update parent process on exit to prevent zombies

### 🚜 Refactor

- Moved middleware code to new file
- Improved spectrogram generation
- Moved middleware code to new file
- *(database)* Move save to common interface and change it to use transaction
- *(analyser)* BirdNET Predict function and related types
- *(audio)* Stopped audio device is now simply started again instead of full audio context restart
- *(audio)* Disabled PulseAudio to prioritise audio capture to use ALSA on Linux
- *(audio)* Set audio backend to fixed value based on OS
- *(config)* Refactor RSTP config settings
- *(processor)* Increase dog bark filter scope to 15 minutes and fix log messages
- *(rtsp)* Improve FFmpeg process restarts and stopping on main process exit
- *(labels)* Update makefile to zip labels.zip during build and have label files available in internal/birdnet/labels to make it easier to contribute language updates
- *(audio)* Improve way start time of audio capture is calculated

### 📚 Documentation

- *(capture)* Add documentation to audiobuffer.go

### 🎨 Styling

- Remove old commented code
- *(docker)* Removed commented out code

### ⚙️ Miscellaneous Tasks

- *(assets)* Upgrade htmx to 1.9.11

### Build

- *(deps)* Add zip to build image during build
- *(deps)* Bump gorm.io/driver/mysql from 1.5.4 to 1.5.6
- *(deps)* Bump gorm.io/gorm from 1.25.7 to 1.25.8

### Enh

- *(database)* Switched sqlite journalling to MEMORY mode and added database optimize on closing
- *(workflow)* Update GitHub Actions workflow to build and push Docker image to GHCR
- *(workflow)* Update Docker actions versions
- *(workflow)* Support multiplatform build with github actions
- *(docker)* Add ffmpeg to container image
- *(labels)* Add Greek (el) translations by @hoover67
- *(ui)* Improve spectrogram generation to enable lazy loading of images
- *(make)* Improve make file

### Github

- *(workflow)* Add windows build workflow
- *(workflow)* Updated windows build workflow

## [0.3.0] - 2023-11-04

### 🚀 Features

- Added directory command
- Config file support
- Config file support

### 🐛 Bug Fixes

- Estimated time remaining print fixed
- Start and end time fix for stdout

<!-- generated by git-cliff -->
