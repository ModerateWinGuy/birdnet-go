import"./index.js";import{p as ma,s as A,b as Bt,z as fa,k,o as e,l as o,i as m,g as t,n as g,m as ba,R as st,h as u,j as wa,t as rt,B as T,_ as lt,c as ka,f as xa,E as ya,d as Ca,q as ja,r as it,w as Ma,y as D}from"./vendor.js";function nt(f,i,s){g(i,1),s()}async function Aa(f,i,s){const h=t(i).filter(r=>!r.read).map(r=>r.id);await Promise.all(h.map(r=>s(r)))}async function za(f,i,s,h,r,x,y,z){if(!t(i))return;const C=t(i);g(i,null);try{const j=await fetch(`/api/v2/notifications/${C}`,{method:"DELETE",headers:{"X-CSRF-Token":s()}});if(j.ok){t(h)?.close();const d=t(r).findIndex(M=>M.id===C);if(d!==-1){const M=!t(r)[d].read;t(r).splice(d,1),g(x,t(r).some(b=>!b.read),!0),window.dispatchEvent(new CustomEvent("notification-deleted",{detail:{id:C,wasUnread:M}})),t(r).length===0&&t(y)>1&&(lt(y,-1),await z())}}else{t(h)?.close();const d=await j.json().catch(()=>({}));alert(d.error||"Failed to delete notification. Please try again.")}}catch{t(h)?.close(),alert("Network error occurred. Please try again.")}}function La(f,i,s){t(i)>1&&(lt(i,-1),s())}function Ba(f,i,s,h){t(i)<t(s)&&(lt(i),h())}var Ra=k('<button class="btn btn-sm btn-ghost">Mark All Read</button>'),Sa=k('<div class="card bg-base-100 shadow-sm"><div class="card-body"><div class="flex justify-center"><div class="loading loading-spinner loading-lg"></div></div></div></div>'),Ta=k('<div class="card bg-base-100 shadow-sm"><div class="card-body text-center py-12"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 mx-auto mb-4 opacity-30"><path stroke-linecap="round" stroke-linejoin="round" d="M9.143 17.082a24.248 24.248 0 003.844.148m-3.844-.148a23.856 23.856 0 01-5.455-1.31 8.964 8.964 0 002.3-5.542m3.155 6.852a3 3 0 005.667 1.97m1.965-2.277L21 21m-4.225-4.225a23.81 23.81 0 003.536-1.003A8.967 8.967 0 0118 9.75V9A6 6 0 006.53 6.53m10.245 10.245L6.53 6.53M3 3l3.53 3.53"></path></svg> <p class="text-lg text-base-content/60">No notifications found</p> <p class="text-sm text-base-content/40">Adjust your filters or check back later</p></div></div>'),Pa=D('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"></path></svg>'),Da=D('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"></path></svg>'),Fa=D('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"></path></svg>'),Na=D('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"></path></svg>'),Ea=D('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'),Ua=k('<span class="badge badge-ghost badge-sm"> </span>'),Ha=(f,i,s)=>i(t(s).id),Ia=k('<button class="btn btn-ghost btn-xs" aria-label="Mark as read"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></button>'),Va=(f,i,s)=>i(t(s).id),Xa=k('<button class="btn btn-ghost btn-xs" aria-label="Acknowledge"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path></svg></button>'),qa=(f,i,s)=>i(t(s).id),Ja=k('<article><div class="card-body"><div class="flex items-start gap-4"><div class="flex-shrink-0"><div><!></div></div> <div class="flex-1"><div class="flex items-start justify-between gap-4"><div><h3 class="font-semibold text-lg"> </h3> <p class="text-base-content/80 mt-1"> </p> <div class="flex flex-wrap items-center gap-2 mt-3"><!> <span> </span> <time class="text-xs text-base-content/60"> </time></div></div> <div class="flex items-center gap-2"><!> <!> <button class="btn btn-ghost btn-xs text-error" aria-label="Delete"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg></button></div></div></div></div></div></article>'),Wa=k('<div class="flex justify-center mt-6" aria-label="Pagination"><div class="join"><button class="join-item btn btn-sm">«</button> <button class="join-item btn btn-sm btn-active"> </button> <button class="join-item btn btn-sm">»</button></div></div>'),$a=(f,i)=>g(i,null),Ga=k('<div class="col-span-12 p-4"><div class="mb-4"><h1 class="text-3xl font-bold mb-2">Notifications</h1> <p class="text-base-content/70">View and manage all system notifications</p></div> <div class="card bg-base-100 shadow-sm mb-6"><div class="card-body"><div class="flex flex-wrap gap-4 items-center justify-between"><div class="flex flex-wrap gap-2"><select class="select select-sm select-bordered" aria-label="Filter by status"><option>All Status</option><option>Unread</option><option>Read</option><option>Acknowledged</option></select> <select class="select select-sm select-bordered" aria-label="Filter by type"><option>All Types</option><option>Errors</option><option>Warnings</option><option>Info</option><option>System</option><option>Detections</option></select> <select class="select select-sm select-bordered" aria-label="Filter by priority"><option>All Priorities</option><option>Critical</option><option>High</option><option>Medium</option><option>Low</option></select></div> <div class="flex gap-2"><!> <button class="btn btn-sm btn-ghost" aria-label="Refresh notifications"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg> Refresh</button></div></div></div></div> <div class="space-y-4" role="region" aria-label="Notifications list"><!> <!></div> <dialog class="modal"><div class="modal-box"><h3 class="font-bold text-lg">Confirm Delete</h3> <p class="py-4">Are you sure you want to delete this notification?</p> <div class="modal-action"><form method="dialog" class="flex gap-2"><button class="btn btn-ghost">Cancel</button> <button type="button" class="btn btn-error">Delete</button></form></div></div> <form method="dialog" class="modal-backdrop"><button>close</button></form></dialog></div>');function Qa(f,i){ma(i,!0);let s=A(Bt([])),h=A(!1),r=A(1),x=A(1),y=20,z=A(!1),C=A(null),j=A(null),d=Bt({status:"",type:"",priority:""});function M(){const a=document.querySelector('meta[name="csrf-token"]');return a?a.getAttribute("content"):""}async function b(){g(h,!0);try{const a=new URLSearchParams({limit:y.toString(),offset:((t(r)-1)*y).toString()});d.status&&a.append("status",d.status),d.type&&a.append("type",d.type),d.priority&&a.append("priority",d.priority);const v=await fetch(`/api/v2/notifications?${a}`);if(v.ok){const p=await v.json();g(s,p.notifications||[],!0),g(z,t(s).some(n=>!n.read),!0),p.total!==void 0?g(x,Math.ceil(p.total/y)||1,!0):g(x,t(s).length<y?t(r):t(r)+1,!0)}}catch{}finally{g(h,!1)}}async function ct(a){try{if((await fetch(`/api/v2/notifications/${a}/read`,{method:"PUT",headers:{"X-CSRF-Token":M()}})).ok){const p=t(s).find(n=>n.id===a);p&&(p.read=!0,p.status="read",g(z,t(s).some(n=>!n.read),!0))}}catch{}}async function Rt(a){try{if((await fetch(`/api/v2/notifications/${a}/acknowledge`,{method:"PUT",headers:{"X-CSRF-Token":M()}})).ok){const p=t(s).find(n=>n.id===a);p&&(p.status="acknowledged")}}catch{}}async function St(a){g(C,a,!0),t(j)?.showModal()}function Tt(a){return`w-10 h-10 rounded-full flex items-center justify-center ${{error:"bg-error/20 text-error",warning:"bg-warning/20 text-warning",info:"bg-info/20 text-info",detection:"bg-success/20 text-success",system:"bg-primary/20 text-primary"}[a.type]||"bg-base-300"}`}function Pt(a){return{critical:"badge-error",high:"badge-warning",medium:"badge-info",low:"badge-ghost"}[a]||"badge-ghost"}function Dt(a){const v=new Date(a),n=new Date().getTime()-v.getTime();return n<6e4?"Just now":n<36e5?`${Math.floor(n/6e4)}m ago`:n<864e5?`${Math.floor(n/36e5)}h ago`:n<6048e5?`${Math.floor(n/864e5)}d ago`:v.toLocaleDateString()}fa(()=>{b()});var vt=Ga(),dt=e(o(vt),2),Ft=o(dt),Nt=o(Ft),pt=o(Nt),F=o(pt);F.__change=[nt,r,b];var U=o(F);U.value=U.__value="";var H=e(U);H.value=H.__value="unread";var I=e(H);I.value=I.__value="read";var ut=e(I);ut.value=ut.__value="acknowledged";var N=e(F,2);N.__change=[nt,r,b];var V=o(N);V.value=V.__value="";var X=e(V);X.value=X.__value="error";var q=e(X);q.value=q.__value="warning";var J=e(q);J.value=J.__value="info";var W=e(J);W.value=W.__value="system";var _t=e(W);_t.value=_t.__value="detection";var $=e(N,2);$.__change=[nt,r,b];var G=o($);G.value=G.__value="";var K=e(G);K.value=K.__value="critical";var O=e(K);O.value=O.__value="high";var Q=e(O);Q.value=Q.__value="medium";var gt=e(Q);gt.value=gt.__value="low";var Et=e(pt,2),ht=o(Et);{var Ut=a=>{var v=Ra();v.__click=[Aa,s,ct],u(a,v)};m(ht,a=>{t(z)&&a(Ut)})}var Ht=e(ht,2);Ht.__click=b;var mt=e(dt,2),ft=o(mt);{var It=a=>{var v=Sa();u(a,v)},Vt=(a,v)=>{{var p=w=>{var L=Ta();u(w,L)},n=w=>{var L=ka(),E=xa(L);ya(E,17,()=>t(s),Y=>Y.id,(Y,l)=>{var Z=Ja(),Kt=o(Z),Ot=o(Kt),kt=o(Ot),xt=o(kt),Qt=o(xt);{var Yt=c=>{var _=Pa();u(c,_)},Zt=(c,_)=>{{var P=B=>{var at=Da();u(B,at)},pa=(B,at)=>{{var ua=R=>{var et=Fa();u(R,et)},_a=(R,et)=>{{var ga=S=>{var ot=Na();u(S,ot)},ha=S=>{var ot=Ea();u(S,ot)};m(R,S=>{t(l).type==="detection"?S(ga):S(ha,!1)},et)}};m(B,R=>{t(l).type==="info"?R(ua):R(_a,!1)},at)}};m(c,B=>{t(l).type==="warning"?B(P):B(pa,!1)},_)}};m(Qt,c=>{t(l).type==="error"?c(Yt):c(Zt,!1)})}var ta=e(kt,2),aa=o(ta),yt=o(aa),Ct=o(yt),ea=o(Ct),jt=e(Ct,2),oa=o(jt),sa=e(jt,2),Mt=o(sa);{var ra=c=>{var _=Ua(),P=o(_);rt(()=>T(P,t(l).component)),u(c,_)};m(Mt,c=>{t(l).component&&c(ra)})}var tt=e(Mt,2),ia=o(tt),At=e(tt,2),na=o(At),la=e(yt,2),zt=o(la);{var ca=c=>{var _=Ia();_.__click=[Ha,ct,l],u(c,_)};m(zt,c=>{t(l).read||c(ca)})}var Lt=e(zt,2);{var va=c=>{var _=Xa();_.__click=[Va,Rt,l],u(c,_)};m(Lt,c=>{t(l).read&&t(l).status!=="acknowledged"&&c(va)})}var da=e(Lt,2);da.__click=[qa,St,l],rt((c,_,P)=>{it(Z,1,`card bg-base-100 shadow-sm hover:shadow-md transition-shadow ${t(l).read?"":"bg-base-200/30"}`),it(xt,1,c),T(ea,t(l).title),T(oa,t(l).message),it(tt,1,`badge badge-sm ${_??""}`),T(ia,t(l).priority),Ma(At,"datetime",t(l).timestamp),T(na,P)},[()=>ja(Tt(t(l))),()=>Pt(t(l).priority),()=>Dt(t(l).timestamp)]),u(Y,Z)}),u(w,L)};m(a,w=>{t(s).length===0?w(p):w(n,!1)},v)}};m(ft,a=>{t(h)?a(It):a(Vt,!1)})}var Xt=e(ft,2);{var qt=a=>{var v=Wa(),p=o(v),n=o(p);n.__click=[La,r,b];var w=e(n,2),L=o(w),E=e(w,2);E.__click=[Ba,r,x,b],rt(()=>{n.disabled=t(r)===1,T(L,`Page ${t(r)??""} of ${t(x)??""}`),E.disabled=t(r)===t(x)}),u(a,v)};m(Xt,a=>{!t(h)&&t(x)>1&&a(qt)})}var bt=e(mt,2),Jt=o(bt),Wt=e(o(Jt),4),$t=o(Wt),wt=o($t);wt.__click=[$a,C];var Gt=e(wt,2);Gt.__click=[za,C,M,j,s,z,r,b],ba(bt,a=>g(j,a),()=>t(j)),st(F,()=>d.status,a=>d.status=a),st(N,()=>d.type,a=>d.type=a),st($,()=>d.priority,a=>d.priority=a),u(f,vt),wa()}Ca(["change","click"]);export{Qa as default};
