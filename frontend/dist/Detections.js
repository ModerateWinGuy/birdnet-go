import{c as ne,C as Re}from"./index.js";import{a0 as Oe,p as re,a as b,k as v,Q as xe,i as _,l as t,o as c,t as R,q as oe,r as ie,h as i,j as se,c as he,f as ae,L as ue,S as ye,B as Z,g as o,e as ve,E as Se,d as be,w as ce,F as Me,a1 as De,z as Te,s as te,m as Ce,n as A,y as _e,u as je,a2 as pe,T as ze,K as Pe,b as Be,x as Ee}from"./vendor.js";import{f as ge}from"./api.js";import{L as Ie}from"./LoadingSpinner.js";Oe();var Ve=v('<h2 class="card-title"> </h2>'),He=v('<div class="card-header"><!></div>'),Ze=v('<div class="card-footer"><!></div>'),qe=v("<div><!> <div><!></div> <!></div>");function Ue(C,e){re(e,!0);let a=b(e,"title",3,""),w=b(e,"padding",3,!0),l=b(e,"className",3,""),y=ye(e,["$$slots","$$events","$$legacy","title","padding","className","header","children","footer"]);var s=qe();xe(s,d=>({class:d,...y}),[()=>ne("card bg-base-100 shadow-sm",l())]);var x=t(s);{var M=d=>{var f=He(),O=t(f);{var q=k=>{var n=he(),u=ae(n);ue(u,()=>e.header),i(k,n)},z=(k,n)=>{{var u=m=>{var D=Ve(),B=t(D);R(()=>Z(B,a())),i(m,D)};_(k,m=>{a()&&m(u)},n)}};_(O,k=>{e.header?k(q):k(z,!1)})}i(d,f)};_(x,d=>{(a()||e.header)&&d(M)})}var j=c(x,2),N=t(j);{var r=d=>{var f=he(),O=ae(f);ue(O,()=>e.children),i(d,f)};_(N,d=>{e.children&&d(r)})}var h=c(j,2);{var S=d=>{var f=Ze(),O=t(f);ue(O,()=>e.footer),i(d,f)};_(h,d=>{e.footer&&d(S)})}R(d=>ie(j,1,d),[()=>oe(ne("card-body",{"p-0":!w()}))]),i(C,s),se()}function Fe(C,e,a){e(a()-1)}function We(C,e,a){e(a()+1)}var Je=(C,e)=>e(1),Ge=v('<button class="join-item btn btn-sm btn-disabled" disabled>...</button>'),Ke=v('<button class="join-item btn btn-sm">1</button> <!>',1),Qe=(C,e,a)=>e(o(a)),Ye=v("<button> </button>"),Xe=v('<button class="join-item btn btn-sm btn-disabled" disabled>...</button>'),$e=(C,e,a)=>e(a()),et=v('<!> <button class="join-item btn btn-sm"> </button>',1),tt=v("<!> <!> <!>",1),at=v('<button class="join-item btn btn-sm btn-disabled" disabled> </button>'),nt=v('<nav><div class="join"><button class="join-item btn btn-sm" aria-label="Go to previous page"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <!> <button class="join-item btn btn-sm" aria-label="Go to next page"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg></button></div></nav>');function it(C,e){re(e,!0);let a=b(e,"currentPage",3,1),w=b(e,"totalPages",3,1),l=b(e,"onPageChange",3,()=>{}),y=b(e,"disabled",3,!1),s=b(e,"showPageInfo",3,!0),x=b(e,"maxVisiblePages",3,5),M=b(e,"className",3,""),j=ye(e,["$$slots","$$events","$$legacy","currentPage","totalPages","onPageChange","disabled","showPageInfo","maxVisiblePages","className"]),N=ve(()=>()=>{const k=[];let n=Math.max(1,a()-Math.floor(x()/2)),u=Math.min(w(),n+x()-1);u-n<x()-1&&(n=Math.max(1,u-x()+1));for(let m=n;m<=u;m++)k.push(m);return k});function r(k){k>=1&&k<=w()&&k!==a()&&!y()&&l()(k)}var h=nt();xe(h,k=>({class:k,"aria-label":"Pagination Navigation",...j}),[()=>ne("flex items-center justify-center gap-2",M())]);var S=t(h),d=t(S);d.__click=[Fe,r,a];var f=c(d,2);{var O=k=>{var n=tt(),u=ae(n);{var m=E=>{var H=Ke(),L=ae(H);L.__click=[Je,r];var $=c(L,2);{var F=Y=>{var g=Ge();i(Y,g)};_($,Y=>{o(N)()[0]>2&&Y(F)})}R(()=>L.disabled=y()),i(E,H)};_(u,E=>{o(N)()[0]>1&&E(m)})}var D=c(u,2);Se(D,17,()=>o(N)(),Me,(E,H)=>{var L=Ye();L.__click=[Qe,r,H];var $=t(L);R(F=>{ie(L,1,F),L.disabled=y(),ce(L,"aria-label",`Go to page ${o(H)}`),ce(L,"aria-current",o(H)===a()?"page":void 0),Z($,o(H))},[()=>oe(ne("join-item btn btn-sm",{"btn-active":o(H)===a()}))]),i(E,L)});var B=c(D,2);{var G=E=>{var H=et(),L=ae(H);{var $=g=>{var I=Xe();i(g,I)};_(L,g=>{o(N)()[o(N)().length-1]<w()-1&&g($)})}var F=c(L,2);F.__click=[$e,r,w];var Y=t(F);R(()=>{F.disabled=y(),Z(Y,w())}),i(E,H)};_(B,E=>{o(N)()[o(N)().length-1]<w()&&E(G)})}i(k,n)},q=(k,n)=>{{var u=m=>{var D=at(),B=t(D);R(()=>Z(B,`Page ${a()??""} of ${w()??""}`)),i(m,D)};_(k,m=>{s()&&m(u)},n)}};_(f,k=>{s()&&w()>1?k(O):k(q,!1)})}var z=c(f,2);z.__click=[We,r,a],R(()=>{d.disabled=y()||a()===1,z.disabled=y()||a()===w()}),i(C,h),se()}be(["click"]);var ot=v('<h3 class="mt-4 text-lg font-semibold text-base-content"> </h3>'),rt=v('<p class="mt-2 text-sm text-base-content/70 max-w-md"> </p>'),st=v('<div class="mt-4"><!></div>'),lt=v('<div class="mt-6"><button type="button" class="btn btn-primary"> </button></div>'),ct=v("<div><!> <!> <!> <!> <!></div>");function dt(C,e){re(e,!0);let a=b(e,"title",3,""),w=b(e,"description",3,""),l=b(e,"action",3,null),y=b(e,"className",3,""),s=ye(e,["$$slots","$$events","$$legacy","icon","title","description","action","className","children"]);const x=`<svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-base-content/20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
  </svg>`;var M=ct();xe(M,n=>({class:n,...s}),[()=>ne("flex flex-col items-center justify-center py-12 px-4 text-center",y())]);var j=t(M);{var N=n=>{var u=he(),m=ae(u);ue(m,()=>e.icon),i(n,u)},r=n=>{var u=he(),m=ae(u);De(m,()=>x),i(n,u)};_(j,n=>{e.icon?n(N):n(r,!1)})}var h=c(j,2);{var S=n=>{var u=ot(),m=t(u);R(()=>Z(m,a())),i(n,u)};_(h,n=>{a()&&n(S)})}var d=c(h,2);{var f=n=>{var u=rt(),m=t(u);R(()=>Z(m,w())),i(n,u)};_(d,n=>{w()&&n(f)})}var O=c(d,2);{var q=n=>{var u=st(),m=t(u);ue(m,()=>e.children),i(n,u)};_(O,n=>{e.children&&n(q)})}var z=c(O,2);{var k=n=>{var u=lt(),m=t(u);m.__click=function(...B){l().onClick?.apply(this,B)};var D=t(m);R(()=>Z(D,l().label)),i(n,u)};_(z,n=>{l()&&n(k)})}i(C,M),se()}be(["click"]);var vt=v('<div class="status-badge locked">locked</div>'),ut=v('<div class="status-badge comment">comment</div>'),mt=v("<div><div> </div> <!> <!></div>");function ft(C,e){re(e,!0);let a=b(e,"className",3,"");function w(h){switch(h){case"correct":return"status-badge correct";case"false_positive":return"status-badge false";default:return"status-badge unverified"}}function l(h){switch(h){case"correct":return"correct";case"false_positive":return"false";default:return"unverified"}}var y=mt(),s=t(y),x=t(s),M=c(s,2);{var j=h=>{var S=vt();i(h,S)};_(M,h=>{e.detection.locked&&h(j)})}var N=c(M,2);{var r=h=>{var S=ut();i(h,S)};_(N,h=>{e.detection.comments&&e.detection.comments.length>0&&h(r)})}R((h,S,d)=>{ie(y,1,h),ie(s,1,S),Z(x,d)},[()=>oe(ne("flex flex-wrap gap-1",a())),()=>oe(w(e.detection.verified)),()=>l(e.detection.verified)]),i(C,y),se()}var gt=v("<span> </span>");function ht(C,e){re(e,!0);let a=b(e,"timeOfDay",3,"day"),w=b(e,"size",3,"md"),l=b(e,"className",3,"");const y={"01":{day:"☀️",night:"🌙",description:"Clear sky"},"02":{day:"⛅",night:"☁️",description:"Few clouds"},"03":{day:"☁️",night:"☁️",description:"Scattered clouds"},"04":{day:"☁️",night:"☁️",description:"Broken clouds"},"09":{day:"🌧️",night:"🌧️",description:"Shower rain"},10:{day:"🌦️",night:"🌧️",description:"Rain"},11:{day:"⛈️",night:"⛈️",description:"Thunderstorm"},13:{day:"❄️",night:"❄️",description:"Snow"},50:{day:"🌫️",night:"🌫️",description:"Mist"}},s=ve(()=>e.weatherIcon?e.weatherIcon.substring(0,2):""),x=ve(()=>a()==="night"||e.weatherIcon?.endsWith("n")),M=ve(()=>y[o(s)]||{day:"❓",night:"❓",description:"Unknown"}),j=ve(()=>o(x)?o(M).night:o(M).day),N=ve(()=>o(M).description),r={sm:"text-base",md:"text-lg",lg:"text-xl"};var h=gt(),S=t(h);R(d=>{ie(h,1,d),ce(h,"title",o(N)),ce(h,"aria-label",o(N)),Z(S,o(j))},[()=>oe(ne("inline-block",r[w()],l()))]),i(C,h),se()}function bt(C,e,a){A(e,!0),requestAnimationFrame(a)}var _t=(C,e,a)=>e(a.onReview),wt=v('<span class="badge badge-success badge-sm">✓</span>'),xt=v('<span class="badge badge-error badge-sm">✗</span>'),yt=(C,e,a)=>e(a.onToggleSpecies),kt=_e('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path><path fill-rule="evenodd" d="M1.38 8.28a.87.87 0 0 1 0-.566 7.003 7.003 0 0 1 13.238.006.87.87 0 0 1 0 .566A7.003 7.003 0 0 1 1.379 8.28ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" clip-rule="evenodd"></path></svg>'),Ct=_e('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l10.5 10.5a.75.75 0 1 0 1.06-1.06l-1.322-1.323a7.012 7.012 0 0 0 2.16-3.11.87.87 0 0 0 0-.567A7.003 7.003 0 0 0 4.82 3.76l-1.54-1.54Zm3.196 3.195 1.135 1.136A1.502 1.502 0 0 1 9.45 8.389l1.136 1.135a3 3 0 0 0-4.109-4.109Z" clip-rule="evenodd"></path><path d="m7.812 10.994 1.816 1.816A7.003 7.003 0 0 1 1.38 8.28a.87.87 0 0 1 0-.566 6.985 6.985 0 0 1 1.113-2.039l2.513 2.513a3 3 0 0 0 2.806 2.806Z"></path></svg>'),pt=(C,e,a)=>e(a.onToggleLock),Pt=_e('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path d="M11.5 1A3.5 3.5 0 0 0 8 4.5V7H2.5A1.5 1.5 0 0 0 1 8.5v5A1.5 1.5 0 0 0 2.5 15h7a1.5 1.5 0 0 0 1.5-1.5v-5A1.5 1.5 0 0 0 9.5 7V4.5a2 2 0 1 1 4 0v1.75a.75.75 0 0 0 1.5 0V4.5A3.5 3.5 0 0 0 11.5 1Z"></path></svg>'),Nt=_e('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M8 1a3.5 3.5 0 0 0-3.5 3.5V7A1.5 1.5 0 0 0 3 8.5v5A1.5 1.5 0 0 0 4.5 15h7a1.5 1.5 0 0 0 1.5-1.5v-5A1.5 1.5 0 0 0 11.5 7V4.5A3.5 3.5 0 0 0 8 1Zm2 6V4.5a2 2 0 1 0-4 0V7h4Z" clip-rule="evenodd"></path></svg>'),St=(C,e,a)=>e(a.onDelete),Mt=v('<li><button class="text-sm w-full text-left text-error" role="menuitem"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z" clip-rule="evenodd"></path></svg> <span>Delete detection</span></div></button></li>'),Tt=v('<ul class="fixed menu p-2 shadow-lg bg-base-100 rounded-box w-52 border border-base-300 svelte-1hht6q5" role="menu"><li><button class="text-sm w-full text-left" role="menuitem"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path d="M13.488 2.513a1.75 1.75 0 0 0-2.475 0L6.75 6.774a2.75 2.75 0 0 0-.596.892l-.848 2.047a.75.75 0 0 0 .98.98l2.047-.848a2.75 2.75 0 0 0 .892-.596l4.261-4.262a1.75 1.75 0 0 0 0-2.474Z"></path><path d="M4.75 3.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V9A.75.75 0 0 1 14 9v2.25A2.75 2.75 0 0 1 11.25 14h-6.5A2.75 2.75 0 0 1 2 11.25v-6.5A2.75 2.75 0 0 1 4.75 2H7a.75.75 0 0 1 0 1.5H4.75Z"></path></svg> <span>Review detection</span> <!></div></button></li> <li><button class="text-sm w-full text-left" role="menuitem"><div class="flex items-center gap-2"><!> <span> </span></div></button></li> <li><button class="text-sm w-full text-left" role="menuitem"><div class="flex items-center gap-2"><!> <span> </span></div></button></li> <!></ul>'),jt=v('<div><button class="btn btn-ghost btn-xs" aria-label="Actions menu" aria-haspopup="true"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path></svg></button> <!></div>');function Lt(C,e){re(e,!0);let a=b(e,"isExcluded",3,!1),w=b(e,"className",3,""),l=te(!1),y,s;function x(){if(!s||!y)return;const f=y.getBoundingClientRect(),O=window.innerHeight-f.bottom,q=f.top,z=s.offsetHeight;s.style.position="fixed",s.style.zIndex="50",O<z&&q>O?(s.style.bottom=`${window.innerHeight-f.top+8}px`,s.style.top="auto"):(s.style.top=`${f.bottom+8}px`,s.style.bottom="auto"),s.style.left="auto",s.style.right=`${window.innerWidth-f.right}px`}function M(f){A(l,!1),f&&f()}function j(f){o(l)&&s&&!s.contains(f.target)&&y&&!y.contains(f.target)&&A(l,!1)}function N(f){o(l)&&f.key==="Escape"&&(A(l,!1),y?.focus())}Te(()=>(document.addEventListener("click",j),document.addEventListener("keydown",N),()=>{document.removeEventListener("click",j),document.removeEventListener("keydown",N)}));var r=jt(),h=t(r);h.__click=[bt,l,x],Ce(h,f=>y=f,()=>y);var S=c(h,2);{var d=f=>{var O=Tt(),q=t(O),z=t(q);z.__click=[_t,M,e];var k=t(z),n=c(t(k),4);{var u=p=>{var V=wt();i(p,V)},m=(p,V)=>{{var X=de=>{var ke=xt();i(de,ke)};_(p,de=>{e.detection.review?.verified==="false_positive"&&de(X)},V)}};_(n,p=>{e.detection.review?.verified==="correct"?p(u):p(m,!1)})}var D=c(q,2),B=t(D);B.__click=[yt,M,e];var G=t(B),E=t(G);{var H=p=>{var V=kt();i(p,V)},L=p=>{var V=Ct();i(p,V)};_(E,p=>{a()?p(H):p(L,!1)})}var $=c(E,2),F=t($),Y=c(D,2),g=t(Y);g.__click=[pt,M,e];var I=t(g),W=t(I);{var J=p=>{var V=Pt();i(p,V)},K=p=>{var V=Nt();i(p,V)};_(W,p=>{e.detection.locked?p(J):p(K,!1)})}var ee=c(W,2),le=t(ee),P=c(Y,2);{var U=p=>{var V=Mt(),X=t(V);X.__click=[St,M,e],i(p,V)};_(P,p=>{e.detection.locked||p(U)})}Ce(O,p=>s=p,()=>s),R(()=>{Z(F,a()?"Show species":"Ignore species"),Z(le,e.detection.locked?"Unlock detection":"Lock detection")}),i(f,O)};_(S,f=>{o(l)&&f(d)})}R(f=>{ie(r,1,f,"svelte-1hht6q5"),ce(h,"aria-expanded",o(l))},[()=>oe(ne("dropdown relative",w()))]),i(C,r),se()}be(["click"]);async function At(C,e,a){if(!(!e.onConfirm||o(a))){A(a,!0);try{await e.onConfirm()}finally{A(a,!1)}}}var Rt=v('<button type="button" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2" aria-label="Close modal"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Ot=v('<h3 id="modal-title" class="font-bold text-lg mb-4"> </h3>'),Dt=v('<div class="py-4"><!></div>'),zt=v('<div class="modal-action"><!></div>'),Bt=v('<span class="loading loading-spinner loading-sm"></span>'),Et=v('<div class="modal-action"><button type="button" class="btn btn-ghost"> </button> <button type="button"><!> </button></div>'),It=v("<div><div><!> <!> <!> <!></div></div>");function Le(C,e){re(e,!0);let a=b(e,"isOpen",3,!1),w=b(e,"size",3,"md"),l=b(e,"type",3,"default"),y=b(e,"confirmLabel",3,"Confirm"),s=b(e,"cancelLabel",3,"Cancel"),x=b(e,"confirmVariant",3,"primary"),M=b(e,"closeOnBackdrop",3,!0),j=b(e,"closeOnEsc",3,!0),N=b(e,"showCloseButton",3,!0),r=b(e,"loading",3,!1),h=b(e,"className",3,""),S=ye(e,["$$slots","$$events","$$legacy","isOpen","title","size","type","confirmLabel","cancelLabel","confirmVariant","closeOnBackdrop","closeOnEsc","showCloseButton","loading","className","onClose","onConfirm","header","children","footer"]),d=te(!1);const f={sm:"modal-box max-w-sm",md:"modal-box max-w-md",lg:"modal-box max-w-lg",xl:"modal-box max-w-xl",full:"modal-box max-w-full w-full"},O={primary:"btn-primary",secondary:"btn-secondary",accent:"btn-accent",info:"btn-info",success:"btn-success",warning:"btn-warning",error:"btn-error"};function q(g){M()&&g.target===g.currentTarget&&z()}function z(){!r()&&!o(d)&&e.onClose&&e.onClose()}function k(g){j()&&g.key==="Escape"&&!r()&&!o(d)&&z()}je(()=>{if(a())return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}});var n=It();xe(n,g=>({class:g,role:"dialog","aria-modal":"true","aria-labelledby":e.title?"modal-title":void 0,onclick:q,...S}),[()=>ne("modal",{"modal-open":a()})]);var u=t(n),m=t(u);{var D=g=>{var I=Rt();I.__click=z,R(()=>I.disabled=r()||o(d)),i(g,I)};_(m,g=>{N()&&l()==="default"&&g(D)})}var B=c(m,2);{var G=g=>{var I=he(),W=ae(I);ue(W,()=>e.header),i(g,I)},E=(g,I)=>{{var W=J=>{var K=Ot(),ee=t(K);R(()=>Z(ee,e.title)),i(J,K)};_(g,J=>{e.title&&J(W)},I)}};_(B,g=>{e.header?g(G):g(E,!1)})}var H=c(B,2);{var L=g=>{var I=Dt(),W=t(I);ue(W,()=>e.children),i(g,I)};_(H,g=>{e.children&&g(L)})}var $=c(H,2);{var F=g=>{var I=zt(),W=t(I);ue(W,()=>e.footer),i(g,I)},Y=(g,I)=>{{var W=J=>{var K=Et(),ee=t(K);ee.__click=z;var le=t(ee),P=c(ee,2);P.__click=[At,e,d];var U=t(P);{var p=X=>{var de=Bt();i(X,de)};_(U,X=>{o(d)&&X(p)})}var V=c(U);R(X=>{ee.disabled=r()||o(d),Z(le,s()),ie(P,1,X),P.disabled=r()||o(d),Z(V,` ${y()??""}`)},[()=>oe(ne("btn",O[x()]))]),i(J,K)};_(g,J=>{l()!=="default"&&J(W)},I)}};_($,g=>{e.footer?g(F):g(Y,!1)})}R(g=>ie(u,1,g),[()=>oe(ne(f[w()],h()))]),i(C,n),se()}be(["click"]);async function Vt(C,e,a,w,l,y,s,x){if(!(!e()||o(a))){A(a,!0);try{w.onSave?await w.onSave(o(l),o(y),o(s),o(x)):await ge("/api/v2/detections/review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e().id,verified:o(l),lock_detection:o(y),ignore_species:o(s)?e().commonName:null,comment:o(x)})}),w.onClose()}catch(M){console.error("Error saving review:",M)}finally{A(a,!1)}}}var Ht=_e('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path></svg>'),Zt=_e('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),qt=v('<div class="relative"><img loading="lazy" alt="Spectrogram" class="w-full h-auto rounded-md shadow-sm"/></div>'),Ut=v('<div class="alert"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-info shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>No audio recording available for this detection.</span></div>'),Ft=v('<div class="text-sm text-base-content mt-2"><svg xmlns="http://www.w3.org/2000/svg" class="inline-block w-4 h-4 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> This detection is locked. You must unlock it first to change its review status.</div>'),Wt=v('<div class="form-control"><label class="label cursor-pointer justify-start gap-4"><input type="checkbox" class="checkbox checkbox-primary checkbox-xs"/> <span class="label-text">Lock this detection</span></label> <div class="text-sm text-base-content/70 ml-8">Locking this detection will prevent it from being deleted during regular cleanup.</div></div>'),Jt=v(`<div class="form-control"><label class="label cursor-pointer justify-start gap-4"><input type="checkbox" class="checkbox checkbox-primary checkbox-xs"/> <span class="label-text">Ignore this species</span></label> <div class="text-sm text-base-content/70 ml-8">Ignoring this species will prevent future detections of this species. This will not
              remove existing detections.</div></div>`),Gt=v('<div class="space-y-4"><div class="flex items-center gap-2"><p class="text-sm text-base-content/70"> </p> <span><!> </span></div> <div class="mb-4"><!></div> <div class="form-control"><label class="label cursor-pointer justify-start gap-4"><input type="radio" name="verified" class="radio radio-primary radio-xs"/> <span class="label-text">Correct Detection</span></label> <label class="label cursor-pointer justify-start gap-4"><input type="radio" name="verified" class="radio radio-primary radio-xs"/> <span class="label-text">False Positive</span></label> <!></div> <!> <!> <div class="form-control"><label class="label" for="comment-textarea"><span class="label-text">Comment</span></label> <textarea id="comment-textarea" class="textarea textarea-bordered h-24" placeholder="Add a comment"></textarea></div></div>'),Kt=v('<span class="loading loading-spinner loading-sm"></span>'),Qt=v('<button type="button" class="btn">Cancel</button> <button type="button" class="btn btn-primary"><!> Save Review</button>',1);function Yt(C,e){re(e,!0);const a=[];let w=b(e,"isOpen",3,!1),l=b(e,"detection",3,null),y=b(e,"isExcluded",3,!1),s=te("correct"),x=te(!1),M=te(!1),j=te(""),N=te(!1);je(()=>{if(l()){const d=l().review?.verified;A(s,d==="correct"||d==="false_positive"?d:"correct",!0),A(x,l().locked||!1,!0),A(M,y()),A(j,l().comments?.[0]?.entry||"",!0)}});function r(d){switch(d){case"correct":return"badge-success";case"false_positive":return"badge-error";default:return"badge-ghost"}}function h(d){switch(d){case"correct":return"Verified Correct";case"false_positive":return"False Positive";default:return"Not Reviewed"}}const S=ve(()=>`Review Detection: ${l()?.commonName||""}`);Le(C,{get isOpen(){return w()},get title(){return o(S)},size:"lg",showCloseButton:!0,get onClose(){return e.onClose},className:"modal-bottom sm:modal-middle",children:O=>{var q=he(),z=ae(q);{var k=n=>{var u=Gt(),m=t(u),D=t(m),B=t(D),G=c(D,2),E=t(G);{var H=T=>{var Q=Ht();i(T,Q)},L=(T,Q)=>{{var me=fe=>{var we=Zt();i(fe,we)};_(T,fe=>{l().review?.verified==="false_positive"&&fe(me)},Q)}};_(E,T=>{l().review?.verified==="correct"?T(H):T(L,!1)})}var $=c(E),F=c(m,2),Y=t(F);{var g=T=>{var Q=qt(),me=t(Q);R(()=>ce(me,"src",`/api/v2/media/spectrogram?clip=${l().clipName}`)),i(T,Q)},I=T=>{var Q=Ut();i(T,Q)};_(Y,T=>{l().clipName?T(g):T(I,!1)})}var W=c(F,2),J=t(W),K=t(J);K.value=K.__value="correct";var ee=c(J,2),le=t(ee);le.value=le.__value="false_positive";var P=c(ee,2);{var U=T=>{var Q=Ft();i(T,Q)};_(P,T=>{l().locked&&T(U)})}var p=c(W,2);{var V=T=>{var Q=Wt(),me=t(Q),fe=t(me);Pe(fe,()=>o(x),we=>A(x,we)),i(T,Q)};_(p,T=>{o(s)==="correct"&&T(V)})}var X=c(p,2);{var de=T=>{var Q=Jt(),me=t(Q),fe=t(me);Pe(fe,()=>o(M),we=>A(M,we)),i(T,Q)};_(X,T=>{!l().locked&&o(s)==="false_positive"&&T(de)})}var ke=c(X,2),Ae=c(t(ke),2);R((T,Q)=>{Z(B,l().scientificName),ie(G,1,T),Z($,` ${Q??""}`),K.disabled=l().locked,le.disabled=l().locked},[()=>`badge gap-1 ${r(l().review?.verified)}`,()=>h(l().review?.verified)]),pe(a,[],K,()=>o(s),T=>A(s,T)),pe(a,[],le,()=>o(s),T=>A(s,T)),ze(Ae,()=>o(j),T=>A(j,T)),i(n,u)};_(z,n=>{l()&&n(k)})}i(O,q)},footer:O=>{var q=Qt(),z=ae(q);z.__click=function(...m){e.onClose?.apply(this,m)};var k=c(z,2);k.__click=[Vt,l,N,e,s,x,M,j];var n=t(k);{var u=m=>{var D=Kt();i(m,D)};_(n,m=>{o(N)&&m(u)})}R(()=>{z.disabled=o(N),k.disabled=o(N)||!l()}),i(O,q)},$$slots:{default:!0,footer:!0}}),se()}be(["click"]);var Xt=v("<p> </p>");function $t(C,e){let a=b(e,"isOpen",3,!1),w=b(e,"title",3,"Confirm Action"),l=b(e,"message",3,"Are you sure you want to perform this action?"),y=b(e,"confirmLabel",3,"Confirm"),s=b(e,"cancelLabel",3,"Cancel"),x=b(e,"confirmVariant",3,"error");Le(C,{get isOpen(){return a()},get title(){return w()},type:"confirm",size:"sm",get confirmLabel(){return y()},get cancelLabel(){return s()},get confirmVariant(){return x()},get onClose(){return e.onClose},get onConfirm(){return e.onConfirm},className:"modal-bottom sm:modal-middle",children:j=>{var N=Xt(),r=t(N);R(()=>Z(r,l())),i(j,N)},$$slots:{default:!0}})}function Ne(C,e){C.preventDefault(),e.onDetailsClick?.(e.detection.id)}var ea=v('<div class="flex items-center gap-2"><!> <span class="text-xs text-base-content/70"> </span></div>'),ta=v('<div class="text-base-content/50 text-xs">No weather data</div>'),aa=v('<div class="col-span-1"><div class="thumbnail-container w-full max-w-[80px]"><button class="flex items-center justify-center cursor-pointer"><img loading="lazy" class="w-full h-auto rounded-md object-contain"/></button></div></div>'),na=v('<div><div class="col-span-2 text-sm"><span> </span></div> <div class="col-span-1 text-sm"><!></div> <div class="col-span-3 text-sm"><div class="flex items-center gap-3"><!> <button class="hover:text-blue-600 transition-colors cursor-pointer text-left"> </button></div></div> <!> <div class="col-span-2"><!></div> <div><div class="audio-player-container relative min-w-[50px] max-w-[200px]"><img loading="lazy" width="400" alt="Spectrogram" class="w-full h-auto rounded-md object-contain"/> <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-25 p-1 rounded-b-md transition-opacity duration-300 opacity-0 hover:opacity-100 hidden md:block"><div class="flex items-center justify-center"><button class="text-white p-1 rounded-full hover:bg-white hover:bg-opacity-20" title="Audio player coming soon" aria-label="Play audio (coming soon)" disabled><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button></div></div></div></div> <div class="col-span-1 flex justify-end"><!></div></div> <!> <!>',1);function ia(C,e){re(e,!0);let a=b(e,"showThumbnails",3,!1),w=b(e,"isExcluded",3,!1),l=b(e,"className",3,""),y=te(!1),s=te(!1),x=te(Be({title:"",message:"",confirmLabel:"Confirm",onConfirm:()=>{}}));function M(){A(y,!0)}function j(){A(x,{title:w()?`Show Species ${e.detection.commonName}`:`Ignore Species ${e.detection.commonName}`,message:w()?`Are you sure you want to show future detections of ${e.detection.commonName}?`:`Are you sure you want to ignore future detections of ${e.detection.commonName}? This will only affect new detections - existing detections will remain in the database.`,confirmLabel:"Confirm",onConfirm:async()=>{try{await ge("/api/v2/detections/ignore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({common_name:e.detection.commonName})}),e.onRefresh?.()}catch(P){console.error("Error toggling species exclusion:",P)}}},!0),A(s,!0)}function N(){A(x,{title:e.detection.locked?"Unlock Detection":"Lock Detection",message:e.detection.locked?`Are you sure you want to unlock this detection of ${e.detection.commonName}? This will allow it to be deleted during regular cleanup.`:`Are you sure you want to lock this detection of ${e.detection.commonName}? This will prevent it from being deleted during regular cleanup.`,confirmLabel:"Confirm",onConfirm:async()=>{try{await ge(`/api/v2/detections/${e.detection.id}/lock`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locked:!e.detection.locked})}),e.onRefresh?.()}catch(P){console.error("Error toggling lock status:",P)}}},!0),A(s,!0)}function r(){A(x,{title:`Delete Detection of ${e.detection.commonName}`,message:`Are you sure you want to delete detection of ${e.detection.commonName}? This action cannot be undone.`,confirmLabel:"Delete",onConfirm:async()=>{try{await ge(`/api/v2/detections/${e.detection.id}`,{method:"DELETE"}),e.onRefresh?.()}catch(P){console.error("Error deleting detection:",P)}}},!0),A(s,!0)}function h(P){return`/api/v1/thumbnails/${encodeURIComponent(P)}`}function S(P){return P.clipName?`/api/v1/media/spectrogram?clip=${encodeURIComponent(P.clipName)}`:`/api/v1/media/spectrogram?id=${P.id}`}var d=na(),f=ae(d),O=t(f),q=t(O),z=t(q),k=c(O,2),n=t(k);{var u=P=>{var U=ea(),p=t(U);ht(p,{get weatherIcon(){return e.detection.weather.weatherIcon},get timeOfDay(){return e.detection.timeOfDay},size:"sm"});var V=c(p,2),X=t(V);R(()=>Z(X,e.detection.weather.weatherMain||e.detection.weather.description||"")),i(P,U)},m=P=>{var U=ta();i(P,U)};_(n,P=>{e.detection.weather?P(u):P(m,!1)})}var D=c(k,2),B=t(D),G=t(B);Re(G,{get confidence(){return e.detection.confidence},size:"sm"});var E=c(G,2);E.__click=[Ne,e];var H=t(E),L=c(D,2);{var $=P=>{var U=aa(),p=t(U),V=t(p);V.__click=[Ne,e];var X=t(V);R(de=>{ce(V,"aria-label",`View details for ${e.detection.commonName??""}`),ce(X,"src",de),ce(X,"alt",`${e.detection.commonName} thumbnail`)},[()=>h(e.detection.scientificName)]),i(P,U)};_(L,P=>{a()&&P($)})}var F=c(L,2),Y=t(F);ft(Y,{get detection(){return e.detection}});var g=c(F,2),I=t(g),W=t(I),J=c(g,2),K=t(J);Lt(K,{get detection(){return e.detection},get isExcluded(){return w()},onReview:M,onToggleSpecies:j,onToggleLock:N,onDelete:r});var ee=c(f,2);Yt(ee,{get isOpen(){return o(y)},get detection(){return e.detection},get isExcluded(){return w()},onClose:()=>A(y,!1),onSave:async(P,U,p,V)=>{await ge(`/api/v2/detections/${e.detection.id}/review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({verified:P,lock_detection:U,ignore_species:p?e.detection.commonName:null,comment:V})}),e.onRefresh?.()}});var le=c(ee,2);$t(le,{get isOpen(){return o(s)},get title(){return o(x).title},get message(){return o(x).message},get confirmLabel(){return o(x).confirmLabel},onClose:()=>A(s,!1),onConfirm:async()=>{await o(x).onConfirm(),A(s,!1)}}),R((P,U)=>{ie(f,1,P),Z(z,`${e.detection.date??""} ${e.detection.time??""}`),Z(H,e.detection.commonName),ie(g,1,oe(a()?"col-span-2":"col-span-3")),ce(W,"src",U)},[()=>oe(ne("grid grid-cols-12 gap-4 items-center px-4 py-1 hover:bg-gray-50 transition-colors",l())),()=>S(e.detection)]),Ee("error",W,P=>{const U=P.currentTarget;U.onerror=null,U.src="/assets/images/spectrogram-placeholder.svg"}),i(C,d),se()}be(["click"]);var oa=v('<div class="flex justify-center items-center py-8"><!></div>'),ra=v('<div class="px-4 py-8"><div class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div></div>'),sa=v('<div class="col-span-1">Thumbnail</div>'),la=v('<div class="grid grid-cols-12 gap-4 text-xs px-4 pb-2 border-b border-gray-200"><div class="col-span-2">Date & Time</div> <div class="col-span-1">Weather</div> <div class="col-span-3">Species</div> <!> <div class="col-span-2">Status</div> <div>Recording</div> <div class="col-span-1 text-right">Actions</div></div> <div class="divide-y divide-gray-100"></div>',1),ca=v('<div class="border-t border-base-200"><div class="flex flex-col sm:flex-row justify-between items-center p-4 gap-4"><div class="text-sm text-base-content/70 order-2 sm:order-1"> </div> <div class="order-1 sm:order-2"><!></div></div></div>'),da=v('<div class="card-body grow-0 p-2 sm:p-4 sm:pt-3"><div class="flex justify-between"><span class="card-title grow text-base sm:text-xl"> </span></div></div> <div class="block w-full overflow-x-auto"><!></div> <!>',1);function va(C,e){re(e,!0);let a=b(e,"loading",3,!1),w=b(e,"error",3,null),l=b(e,"className",3,"");const y=ve(()=>()=>{if(!e.data)return"Detections";switch(e.data.queryType){case"hourly":return e.data.duration&&e.data.duration>1?`Hourly Results from ${e.data.hour}:00 to ${(e.data.hour||0)+e.data.duration}:00 on ${e.data.date}`:`Hourly Results for ${e.data.hour}:00 on ${e.data.date}`;case"species":return`Results for ${e.data.species} on ${e.data.date}`;case"search":return`Search Results for "${e.data.search}"`;default:return`All Detections for ${e.data.date}`}});function s(x){e.onPageChange&&e.data&&((x-1)*e.data.itemsPerPage,e.onPageChange(x))}Ue(C,{get className(){return l()},children:(x,M)=>{var j=da(),N=ae(j),r=t(N),h=t(r),S=t(h),d=c(N,2),f=t(d);{var O=n=>{var u=oa(),m=t(u);Ie(m,{size:"lg"}),i(n,u)},q=(n,u)=>{{var m=B=>{var G=ra(),E=t(G),H=c(t(E),2),L=t(H);R(()=>Z(L,w())),i(B,G)},D=(B,G)=>{{var E=L=>{dt(L,{title:"No detections found",description:"Try adjusting your filters or search criteria",className:"py-8"})},H=L=>{var $=la(),F=ae($),Y=c(t(F),6);{var g=J=>{var K=sa();i(J,K)};_(Y,J=>{e.data.dashboardSettings?.thumbnails?.summary&&J(g)})}var I=c(Y,4),W=c(F,2);Se(W,21,()=>e.data.notes,Me,(J,K)=>{const ee=ve(()=>e.data.dashboardSettings?.thumbnails?.summary);ia(J,{get detection(){return o(K)},get showThumbnails(){return o(ee)},get onDetailsClick(){return e.onDetailsClick},get onRefresh(){return e.onRefresh}})}),R(()=>ie(I,1,oe(e.data.dashboardSettings?.thumbnails?.summary?"col-span-2":"col-span-3"))),i(L,$)};_(B,L=>{!e.data||e.data.notes.length===0?L(E):L(H,!1)},G)}};_(n,B=>{w()?B(m):B(D,!1)},u)}};_(f,n=>{a()?n(O):n(q,!1)})}var z=c(d,2);{var k=n=>{var u=ca(),m=t(u),D=t(m),B=t(D),G=c(D,2),E=t(G);it(E,{get currentPage(){return e.data.currentPage},get totalPages(){return e.data.totalPages},onPageChange:s,showPageInfo:!1}),R(()=>Z(B,`Showing ${e.data.showingFrom??""} to ${e.data.showingTo??""} of ${e.data.totalResults??""} results`)),i(n,u)};_(z,n=>{e.data&&e.data.totalResults>e.data.itemsPerPage&&n(k)})}R(n=>Z(S,n),[()=>o(y)()]),i(x,j)},$$slots:{default:!0}}),se()}var ua=v('<div class="col-span-12 space-y-6"><!></div>');function ma(C,e){re(e,!0);let a=te(null),w=te(!0),l=te(null);function y(){const r=new URLSearchParams(window.location.search);return{queryType:r.get("queryType")||"all",date:r.get("date")||new Date().toISOString().split("T")[0],hour:r.get("hour")||void 0,duration:r.get("duration")?parseInt(r.get("duration")):void 0,species:r.get("species")||void 0,search:r.get("search")||void 0,numResults:parseInt(r.get("numResults")||"50"),offset:parseInt(r.get("offset")||"0")}}async function s(){A(w,!0),A(l,null);try{const r=y(),h=new URLSearchParams;Object.entries(r).forEach(([d,f])=>{f!==void 0&&h.append(d,String(f))});const S=await ge(`/api/v2/detections?${h.toString()}`);A(a,{notes:S.data||[],queryType:r.queryType||"all",date:r.date,hour:r.hour?parseInt(r.hour):void 0,duration:r.duration,species:r.species,search:r.search,numResults:r.numResults,offset:r.offset,totalResults:S.total||0,itemsPerPage:S.limit||r.numResults||50,currentPage:S.current_page||1,totalPages:S.total_pages||1,showingFrom:(r.offset||0)+1,showingTo:Math.min((r.offset||0)+(S.data?.length||0),S.total||0),dashboardSettings:S.dashboardSettings},!0)}catch(r){A(l,r instanceof Error?r.message:"Failed to fetch detections",!0),console.error("Error fetching detections:",r)}finally{A(w,!1)}}function x(r){if(o(a)){const h=(r-1)*o(a).itemsPerPage,S=new URLSearchParams(window.location.search);S.set("offset",String(h)),window.location.href=`${window.location.pathname}?${S.toString()}`}}function M(r){window.location.href=`/detections/${r}`}Te(()=>{s()});var j=ua(),N=t(j);va(N,{get data(){return o(a)},get loading(){return o(w)},get error(){return o(l)},onPageChange:x,onDetailsClick:M,onRefresh:s}),i(C,j),se()}function _a(C){ma(C,{})}export{_a as default};
