class c extends Error{status;response;userMessage;constructor(t,s,n){super(t),this.name="ApiError",this.status=s,this.response=n,this.userMessage=t}}function f(){const e=document.querySelector('meta[name="csrf-token"]');if(e){const s=e.getAttribute("content");if(s)return s}const t=document.cookie.split(";");for(const s of t){const[n,a]=s.trim().split("=");if(n==="csrf")return decodeURIComponent(a)}return null}function l(){const e=new Headers({"Content-Type":"application/json"}),t=f();return t&&e.set("X-CSRF-Token",t),e}async function h(e){if(!e.ok){let n=`HTTP ${e.status}: ${e.statusText}`;try{const a=await e.json();a.error?n=a.error:a.message&&(n=a.message)}catch{}throw new c(n,e.status,e)}return e.headers.get("content-length")==="0"||e.status===204?null:e.headers.get("content-type")?.includes("application/json")?e.json():e.text()}async function r(e,t={}){const s={method:"GET",headers:l(),credentials:"same-origin"};if(t.headers){const o=new Headers(t.headers),i=s.headers;for(const[u,d]of o)i.set(u,d);t.headers=i}let n;t.body&&(t.body instanceof FormData||typeof t.body=="string"?n=t.body:n=JSON.stringify(t.body));const a={...s,...t,body:n};try{const o=await fetch(e,a);return await h(o)}catch(o){throw o instanceof c&&g(o),o}}function g(e){e instanceof c&&(e.name==="AbortError"?e.userMessage="Request was cancelled":e.status===401?e.userMessage="You need to log in to access this resource":e.status===403?e.userMessage="You do not have permission to access this resource":e.status===404?e.userMessage="The requested resource was not found":e.status>=500?e.userMessage="A server error occurred. Please try again later":navigator.onLine||(e.userMessage="No internet connection"))}const y={get(e,t={}){return r(e,{...t,method:"GET"})},post(e,t,s={}){return r(e,{...s,method:"POST",body:t})},put(e,t,s={}){return r(e,{...s,method:"PUT",body:t})},patch(e,t,s={}){return r(e,{...s,method:"PATCH",body:t})},delete(e,t={}){return r(e,{...t,method:"DELETE"})}};export{y as a,r as f};
